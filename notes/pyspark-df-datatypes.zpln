{"paragraphs":[{"text":"%spark.conf\n\nSPARK_HOME /opt/cloudera/parcels/CDH-6.3.2-1.cdh6.3.2.p0.1605554/lib/spark\nmaster local[*]\nspark.driver.memory 512M\nspark.executor.instances  2\nspark.executor.memory  512M\n","user":"anonymous","dateUpdated":"2021-12-13T21:04:01+0530","progress":0,"config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639409576586_1256700125","id":"paragraph_1639409576586_1256700125","dateCreated":"2021-12-13T21:02:56+0530","dateStarted":"2021-12-13T21:04:01+0530","dateFinished":"2021-12-13T21:04:01+0530","status":"FINISHED","focus":false},{"text":"%pyspark\nfrom pyspark.sql.types import *\n\n#\n#\n#\nstructureData = [\n    ((\"James\",\"\",\"Smith\"),\"36636\",\"Sales\",34,\"2006-01-01\",\"true\",[\"Java\",\"Scala\",\"C++\"],{'hair':'black','eye':'brown'},\"M\",3100.50,\"OH\",\"07-01-2019 12 01 19 406\"),\n    ((\"Michael\",\"Rose\",\"\"),\"40288\",\"Finance\",25,\"2006-01-01\",\"true\",[\"Java\",\"Scala\",\"C++\"],{'hair':'black','eye':'brown'},\"M\",4300.65,\"CA\",\"06-24-2019 12 01 19 406\"),\n    ((\"Robert\",\"\",\"Williams\"),\"42114\",\"Marketing\",27,\"1992-06-23\",\"false\",[\"Java\",\"Scala\",\"C++\"],{'hair':'black','eye':'brown'},\"M\",1400.80,\"NJ\",\"11-16-2019 16 50 59 406\"),\n    ((\"Maria\",\"Anne\",\"Jones\"),\"39192\",\"Finance\",19,\"1987-05-05\",\"false\",[\"Java\",\"Scala\",\"C++\"],{'hair':'black','eye':'brown'},\"F\",5500.75,\"NY\",\"11-16-2019 16 50 59 406\"),\n    ((\"Jen\",\"Mary\",\"Brown\"),\"39191\",\"Marketing\",24,\"1990-01-01\",\"false\",[\"Java\",\"Scala\",\"C++\"],{'hair':'black','eye':'brown'},\"F\",-1,\"UT\",\"11-16-2019 16 50 59 406\"),\n    ((\"Jeff\",\"A\",\"Jones\"),\"39192\",\"Finance\",19,\"2000-07-17\",\"false\",[\"Java\",\"Scala\",\"C++\"],{'hair':'black','eye':'brown'},\"F\",5500.75,\"CA\",\"11-16-2019 16 50 59 406\"),\n    ((\"Scott\",\"M\",\"Brown\"),\"39191\",\"Marketing\",24,\"1994-10-01\",\"false\",[\"Java\",\"Scala\",\"C++\"],{'hair':'black','eye':'brown'},\"F\",-1,\"FL\",\"11-16-2019 16 50 59 406\")\n  ]\n\n#\n#\n#\nschema = StructType([\n        StructField(\"name\", StructType([\n            StructField(\"fname\", StringType(), True),\n            StructField(\"middle\", StringType(), True),\n            StructField(\"last\", StringType(), True),\n        ])),\n        StructField(\"id\", StringType(), True),\n        StructField(\"department\", StringType(), True),\n        StructField(\"age\", StringType(), True), \n        StructField(\"jobStartDate\", StringType(), True), \n        StructField(\"isGraduated\", StringType(), True),\n        StructField('languages', ArrayType(StringType()), True),\n        StructField('properties', MapType(StringType(),StringType()),True), \n        StructField(\"gender\", StringType(), True), \n        StructField(\"salary\", StringType(), True),\n        StructField(\"state\", StringType(), True),\n        StructField(\"addts\", StringType(), True)\n    ])","user":"anonymous","dateUpdated":"2021-12-14T10:44:08+0530","progress":0,"config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639409641645_1113256137","id":"paragraph_1639409641645_1113256137","dateCreated":"2021-12-13T21:04:01+0530","dateStarted":"2021-12-14T10:41:39+0530","dateFinished":"2021-12-14T10:41:39+0530","status":"FINISHED","focus":false},{"text":"%pyspark\n\n#\n#\ndf1 = spark.createDataFrame(data=structureData, schema=schema)\ndf1.printSchema()","user":"anonymous","dateUpdated":"2021-12-14T10:41:44+0530","progress":0,"config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- name: struct (nullable = true)\n |    |-- fname: string (nullable = true)\n |    |-- middle: string (nullable = true)\n |    |-- last: string (nullable = true)\n |-- id: string (nullable = true)\n |-- department: string (nullable = true)\n |-- age: string (nullable = true)\n |-- jobStartDate: string (nullable = true)\n |-- isGraduated: string (nullable = true)\n |-- languages: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- properties: map (nullable = true)\n |    |-- key: string\n |    |-- value: string (valueContainsNull = true)\n |-- gender: string (nullable = true)\n |-- salary: string (nullable = true)\n |-- state: string (nullable = true)\n |-- addts: string (nullable = true)\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639409650868_773043775","id":"paragraph_1639409650868_773043775","dateCreated":"2021-12-13T21:04:10+0530","dateStarted":"2021-12-14T10:41:44+0530","dateFinished":"2021-12-14T10:41:44+0530","status":"FINISHED","focus":false},{"text":"%pyspark\n\n#\n#\ndf1.select(\"name.fname\", \"name.middle\", \"name.last\", \"id\", \"department\", \"age\", \"jobStartDate\", \"isGraduated\", \"languages\", \"properties\", \"gender\", \"salary\", \"state\", \"addts\").show()\n\n#\n#\nfrom pyspark.sql.functions import explode\ndf1.select(df1.id,explode(df1.languages)).show(truncate=False)\n\n#\n#\ndf1.select(df1.id,explode(df1.properties)).show()","user":"anonymous","dateUpdated":"2021-12-14T10:42:11+0530","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+--------+-----+----------+---+------------+-----------+------------------+--------------------+------+-------+-----+--------------------+\n|  fname|middle|    last|   id|department|age|jobStartDate|isGraduated|         languages|          properties|gender| salary|state|               addts|\n+-------+------+--------+-----+----------+---+------------+-----------+------------------+--------------------+------+-------+-----+--------------------+\n|  James|      |   Smith|36636|     Sales| 34|  2006-01-01|       true|[Java, Scala, C++]|[eye -> brown, ha...|     M| 3100.5|   OH|07-01-2019 12 01 ...|\n|Michael|  Rose|        |40288|   Finance| 25|  2006-01-01|       true|[Java, Scala, C++]|[eye -> brown, ha...|     M|4300.65|   CA|06-24-2019 12 01 ...|\n| Robert|      |Williams|42114| Marketing| 27|  1992-06-23|      false|[Java, Scala, C++]|[eye -> brown, ha...|     M| 1400.8|   NJ|11-16-2019 16 50 ...|\n|  Maria|  Anne|   Jones|39192|   Finance| 19|  1987-05-05|      false|[Java, Scala, C++]|[eye -> brown, ha...|     F|5500.75|   NY|11-16-2019 16 50 ...|\n|    Jen|  Mary|   Brown|39191| Marketing| 24|  1990-01-01|      false|[Java, Scala, C++]|[eye -> brown, ha...|     F|     -1|   UT|11-16-2019 16 50 ...|\n|   Jeff|     A|   Jones|39192|   Finance| 19|  2000-07-17|      false|[Java, Scala, C++]|[eye -> brown, ha...|     F|5500.75|   NY|11-16-2019 16 50 ...|\n|  Scott|     M|   Brown|39191| Marketing| 24|  1994-10-01|      false|[Java, Scala, C++]|[eye -> brown, ha...|     F|     -1|   UT|11-16-2019 16 50 ...|\n+-------+------+--------+-----+----------+---+------------+-----------+------------------+--------------------+------+-------+-----+--------------------+\n\n+-----+-----+\n|id   |col  |\n+-----+-----+\n|36636|Java |\n|36636|Scala|\n|36636|C++  |\n|40288|Java |\n|40288|Scala|\n|40288|C++  |\n|42114|Java |\n|42114|Scala|\n|42114|C++  |\n|39192|Java |\n|39192|Scala|\n|39192|C++  |\n|39191|Java |\n|39191|Scala|\n|39191|C++  |\n|39192|Java |\n|39192|Scala|\n|39192|C++  |\n|39191|Java |\n|39191|Scala|\n+-----+-----+\nonly showing top 20 rows\n\n+-----+----+-----+\n|   id| key|value|\n+-----+----+-----+\n|36636| eye|brown|\n|36636|hair|black|\n|40288| eye|brown|\n|40288|hair|black|\n|42114| eye|brown|\n|42114|hair|black|\n|39192| eye|brown|\n|39192|hair|black|\n|39191| eye|brown|\n|39191|hair|black|\n|39192| eye|brown|\n|39192|hair|black|\n|39191| eye|brown|\n|39191|hair|black|\n+-----+----+-----+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=84"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=85"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=86"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=87"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=88"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=89"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=90"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=91"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=92"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639410054579_280770308","id":"paragraph_1639410054579_280770308","dateCreated":"2021-12-13T21:10:54+0530","dateStarted":"2021-12-14T10:42:11+0530","dateFinished":"2021-12-14T10:42:12+0530","status":"FINISHED","focus":false},{"text":"%pyspark\n\n#\n# Change Data Type of column\n#\ndf2 = df1.withColumn(\"id\",col(\"id\").cast(IntegerType()))\\\n.withColumn(\"age\",col(\"age\").cast(IntegerType()))\\\n.withColumn(\"jobStartDate\",col(\"jobStartDate\").cast(DateType()))\\\n.withColumn(\"isGraduated\",col(\"isGraduated\").cast(BooleanType()))\\\n.withColumn(\"gender\",col(\"gender\").cast(StringType()))\\\n.withColumn(\"salary\",col(\"salary\").cast(FloatType()))\\\n.withColumn(\"addts\",to_timestamp(col(\"addts\"),\"MM-dd-yyyy HH mm ss SSS\"))\ndf2.printSchema()","user":"anonymous","dateUpdated":"2021-12-14T10:16:56+0530","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- name: struct (nullable = true)\n |    |-- fname: string (nullable = true)\n |    |-- middle: string (nullable = true)\n |    |-- last: string (nullable = true)\n |-- id: integer (nullable = true)\n |-- age: integer (nullable = true)\n |-- jobStartDate: date (nullable = true)\n |-- isGraduated: boolean (nullable = true)\n |-- languages: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- properties: map (nullable = true)\n |    |-- key: string\n |    |-- value: string (valueContainsNull = true)\n |-- gender: string (nullable = true)\n |-- salary: float (nullable = true)\n |-- state: string (nullable = true)\n |-- addts: timestamp (nullable = true)\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639410101967_760815982","id":"paragraph_1639410101967_760815982","dateCreated":"2021-12-13T21:11:41+0530","dateStarted":"2021-12-14T10:16:56+0530","dateFinished":"2021-12-14T10:16:56+0530","status":"FINISHED","focus":false},{"text":"%pyspark\n\n#\n#\ndf2.show(truncate=False)","user":"anonymous","dateUpdated":"2021-12-14T10:18:20+0530","progress":0,"config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+---+------------+-----------+------------------+-----------------------------+------+-------+-----+-------------------+\n|name                |id   |age|jobStartDate|isGraduated|languages         |properties                   |gender|salary |state|addts              |\n+--------------------+-----+---+------------+-----------+------------------+-----------------------------+------+-------+-----+-------------------+\n|[James, , Smith]    |36636|34 |2006-01-01  |true       |[Java, Scala, C++]|[eye -> brown, hair -> black]|M     |3100.5 |OH   |2019-07-01 12:01:19|\n|[Michael, Rose, ]   |40288|25 |2006-01-01  |true       |[Java, Scala, C++]|[eye -> brown, hair -> black]|M     |4300.65|CA   |2019-06-24 12:01:19|\n|[Robert, , Williams]|42114|27 |1992-06-23  |false      |[Java, Scala, C++]|[eye -> brown, hair -> black]|M     |1400.8 |NJ   |2019-11-16 16:50:59|\n|[Maria, Anne, Jones]|39192|19 |1987-05-05  |false      |[Java, Scala, C++]|[eye -> brown, hair -> black]|F     |5500.75|NY   |2019-11-16 16:50:59|\n|[Jen, Mary, Brown]  |null |24 |1990-01-01  |false      |[Java, Scala, C++]|[eye -> brown, hair -> black]|F     |-1.0   |UT   |2019-11-16 16:50:59|\n+--------------------+-----+---+------------+-----------+------------------+-----------------------------+------+-------+-----+-------------------+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=78"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=79"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=80"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639410123534_1690144218","id":"paragraph_1639410123534_1690144218","dateCreated":"2021-12-13T21:12:03+0530","dateStarted":"2021-12-14T10:18:20+0530","dateFinished":"2021-12-14T10:18:21+0530","status":"FINISHED","focus":false},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-12-14T09:19:18+0530","progress":0,"config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639453758363_1702623615","id":"paragraph_1639453758363_1702623615","dateCreated":"2021-12-14T09:19:18+0530","status":"READY"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import *\n\ndf3 = df1.withColumn(\"OtherInfo\", struct(col(\"id\").alias(\"identifier\"), col(\"gender\").alias(\"gender\"), col(\"salary\").alias(\"salary\"),\n    when(col(\"salary\").cast(IntegerType()) < 2000,\"Low\")\n    .when(col(\"salary\").cast(IntegerType()) < 4000,\"Medium\")\n    .otherwise(\"High\").alias(\"Salary_Grade\")\n  )).drop(\"id\",\"gender\",\"salary\")\n\ndf3.printSchema()\ndf3.show(truncate=False)\n","user":"anonymous","dateUpdated":"2021-12-14T10:26:28+0530","progress":0,"config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- name: struct (nullable = true)\n |    |-- fname: string (nullable = true)\n |    |-- middle: string (nullable = true)\n |    |-- last: string (nullable = true)\n |-- age: string (nullable = true)\n |-- jobStartDate: string (nullable = true)\n |-- isGraduated: string (nullable = true)\n |-- languages: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- properties: map (nullable = true)\n |    |-- key: string\n |    |-- value: string (valueContainsNull = true)\n |-- state: string (nullable = true)\n |-- addts: string (nullable = true)\n |-- OtherInfo: struct (nullable = false)\n |    |-- identifier: string (nullable = true)\n |    |-- gender: string (nullable = true)\n |    |-- salary: string (nullable = true)\n |    |-- Salary_Grade: string (nullable = false)\n\n+--------------------+---+------------+-----------+------------------+-----------------------------+-----+-----------------------+--------------------------+\n|name                |age|jobStartDate|isGraduated|languages         |properties                   |state|addts                  |OtherInfo                 |\n+--------------------+---+------------+-----------+------------------+-----------------------------+-----+-----------------------+--------------------------+\n|[James, , Smith]    |34 |2006-01-01  |true       |[Java, Scala, C++]|[eye -> brown, hair -> black]|OH   |07-01-2019 12 01 19 406|[36636, M, 3100.5, Medium]|\n|[Michael, Rose, ]   |25 |2006-01-01  |true       |[Java, Scala, C++]|[eye -> brown, hair -> black]|CA   |06-24-2019 12 01 19 406|[40288, M, 4300.65, High] |\n|[Robert, , Williams]|27 |1992-06-23  |false      |[Java, Scala, C++]|[eye -> brown, hair -> black]|NJ   |11-16-2019 16 50 59 406|[42114, M, 1400.8, Low]   |\n|[Maria, Anne, Jones]|19 |1987-05-05  |false      |[Java, Scala, C++]|[eye -> brown, hair -> black]|NY   |11-16-2019 16 50 59 406|[39192, F, 5500.75, High] |\n|[Jen, Mary, Brown]  |24 |1990-01-01  |false      |[Java, Scala, C++]|[eye -> brown, hair -> black]|UT   |11-16-2019 16 50 59 406|[, F, -1, Low]            |\n+--------------------+---+------------+-----------+------------------+-----------------------------+-----+-----------------------+--------------------------+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=81"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=82"},{"jobUrl":"http://quickstart-bigdata:4040/jobs/job?id=83"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639410178281_1579009510","id":"paragraph_1639410178281_1579009510","dateCreated":"2021-12-13T21:12:58+0530","dateStarted":"2021-12-14T10:26:28+0530","dateFinished":"2021-12-14T10:26:28+0530","status":"FINISHED","focus":false},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-12-13T21:17:03+0530","progress":0,"config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1639410423929_1223307070","id":"paragraph_1639410423929_1223307070","dateCreated":"2021-12-13T21:17:03+0530","status":"READY"}],"name":"pyspark-data-frames","id":"2GP9RXBET","defaultInterpreterGroup":"spark","version":"0.10.0","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/pyspark/pyspark-data-frames"}